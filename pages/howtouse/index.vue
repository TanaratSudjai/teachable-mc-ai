<template>
  <div class="bg-gradient-to-b from-white to-gray-50">
    <!-- Hero Section with Animated Background -->
    <div class="relative overflow-hidden bg-gradient-to-r from-[#14a468] to-[#0f8c57] text-white">
      <!-- Animated Circles Background -->
      <div class="absolute inset-0 overflow-hidden opacity-20">
        <div class="absolute -top-40 -left-40 w-80 h-80 bg-white rounded-full opacity-20 animate-float-slow"></div>
        <div class="absolute top-20 right-10 w-60 h-60 bg-white rounded-full opacity-10 animate-float-medium"></div>
        <div class="absolute bottom-10 left-20 w-40 h-40 bg-white rounded-full opacity-15 animate-float-fast"></div>
      </div>
      
      <!-- Hero Content -->
      <div class="max-w-4xl mx-auto px-6 py-8 relative z-10">
        <h1 class="text-4xl md:text-5xl font-bold mb-6 text-center">
          <span class="inline-block animate-bounce-short">üì±</span> ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£
        </h1>
        
        <p class="text-xl text-center max-w-2xl mx-auto mb-8 text-white/90">
          ‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏≤‡∏ó‡∏≤‡∏á‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ AI ‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤
        </p>
        
        <!-- Hero Image with Shadow Effect -->
        <div class="relative mx-auto max-w-2xl rounded-xl overflow-hidden shadow-2xl transform hover:scale-[1.02] transition-transform duration-500">
          <img
            src="https://spikeapi.com/wp-content/uploads/2024/07/nutrition_hero-1024x625.jpg"
            class="w-full h-auto"
            alt="AI Food Scanning"
          />
          <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-60"></div>
        </div>
      </div>
    </div>
  </div>
    
    <!-- Steps Section -->
    <div class="max-w-4xl mx-auto px-6 py-8">
      <h2 class="text-3xl font-bold text-[#14a468] mb-10 text-center">
        <span class="relative inline-block">
          ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
          <span class="absolute -bottom-2 left-0 w-full h-1 bg-gradient-to-r from-[#14a468] to-[#0f8c57] rounded-full"></span>
        </span>
      </h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
        <!-- Step 1 -->
        <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 transform hover:-translate-y-1">
          <div class="flex items-center justify-center w-12 h-12 rounded-full bg-[#14a468] text-white font-bold mb-4 mx-auto">
            1
          </div>
          <h3 class="text-lg font-semibold text-center mb-3">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ</h3>
          <p class="text-gray-600 text-center">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏≠‡∏õ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</p>
        </div>
        
        <!-- Step 2 -->
        <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 transform hover:-translate-y-1">
          <div class="flex items-center justify-center w-12 h-12 rounded-full bg-[#14a468] text-white font-bold mb-4 mx-auto">
            2
          </div>
          <h3 class="text-lg font-semibold text-center mb-3">‡∏™‡πÅ‡∏Å‡∏ô‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h3>
          <p class="text-gray-600 text-center">‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</p>
        </div>
        
        <!-- Step 3 -->
        <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 transform hover:-translate-y-1">
          <div class="flex items-center justify-center w-12 h-12 rounded-full bg-[#14a468] text-white font-bold mb-4 mx-auto">
            3
          </div>
          <h3 class="text-lg font-semibold text-center mb-3">‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</h3>
          <p class="text-gray-600 text-center">‡∏£‡∏≠ AI ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</p>
        </div>
      </div>
    </div>

    <div class="max-w-4xl mx-auto px-6 pb-16">
      <!-- Scanning Section Header -->
      <div class="text-center mb-4">
        <h2 class="text-2xl md:text-3xl font-bold text-[#14a468] mb-3">
          <span class="relative inline-block">
            üîç ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏™‡πÅ‡∏Å‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ AI
            <span class="absolute -bottom-2 left-0 w-full h-1 bg-gradient-to-r from-[#14a468] to-[#0f8c57] rounded-full"></span>
          </span>
        </h2>
        <p class="text-gray-600 max-w-2xl mx-auto">
          ‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏Ñ‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ AI ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏≤‡∏ó‡∏≤‡∏á‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£
        </p>
      </div>
      
      <!-- Scanning Options Card -->
      <div class="bg-white rounded-xl shadow-lg p-6 mb-6 max-w-2xl mx-auto">
        <h3 class="text-lg font-semibold text-[#14a468] mb-6 text-center">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô</h3>
        
        <!-- ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô -->
        <div class="flex flex-col sm:flex-row justify-center gap-4 mb-6 items-center">
          <button
            class="bg-gradient-to-r from-[#14a468] to-[#0f8c57] hover:from-[#108c5d] hover:to-[#0d7a4b] text-white px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2 font-medium"
            @click="init"
            v-if="!scanActive"
          >
            <span class="text-xl">üì∑</span> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡πÅ‡∏Å‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏•‡πâ‡∏≠‡∏á
          </button>
          <button
            class="bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2 font-medium"
            @click="stopWebcam"
            v-else
          >
            <span class="text-xl">‚èπÔ∏è</span> ‡∏´‡∏¢‡∏∏‡∏î‡∏™‡πÅ‡∏Å‡∏ô
          </button>
          
          <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û -->
          <label class="cursor-pointer bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2 font-medium">
            <span class="text-xl">üì§</span> ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
            <input type="file" class="hidden" accept="image/*" @change="handleImageUpload" />
          </label>
        </div>
      
      <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î -->
      <div v-if="isLoading" class="mb-8 text-center">
        <div class="relative inline-flex">
          <div class="absolute inset-0 rounded-full bg-gradient-to-r from-[#14a468] to-[#0f8c57] opacity-30 blur-md animate-pulse"></div>
          <div class="relative inline-block animate-spin rounded-full h-16 w-16 border-t-3 border-b-3 border-[#14a468]"></div>
        </div>
        <p class="text-gray-600 mt-4 font-medium animate-pulse">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö AI...</p>
      </div>
      
      <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏Ñ‡∏° -->
      <div v-if="scanActive" class="mb-6">
        <div id="webcam-container" class="flex justify-center mb-2 relative">
          <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏£‡∏≠‡∏ö‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏£‡∏≠‡∏ö‡∏Å‡∏•‡πâ‡∏≠‡∏á -->
          <div class="absolute -inset-2 bg-gradient-to-r from-[#14a468] to-blue-500 rounded-lg opacity-70 blur-sm"></div>
          <div class="relative z-10"></div>
        </div>
        <p class="text-sm text-gray-500 italic">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πÅ‡∏Å‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ AI...</p>
      </div>
      
      <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î -->
      <div v-if="uploadedImage" class="mb-4">
        <div class="relative inline-block">
          <img :src="uploadedImage" class="max-h-[400px] rounded-lg shadow-md" ref="uploadedImageElement" />
          <button 
            @click="clearImage" 
            class="absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white rounded-full w-8 h-8 flex items-center justify-center"
            title="‡∏•‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û"
          >
            ‚úï
          </button>
        </div>
      </div>
      
      <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå -->
      <div v-if="currentFood" class="bg-white rounded-lg shadow-lg p-6 mb-6 max-w-md mx-auto">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-xl font-bold text-[#14a468]">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</h3>
          <div class="bg-[#14a468] text-white text-xs px-2 py-1 rounded-full">{{ (currentFood.confidence * 100).toFixed(0) }}% ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</div>
        </div>
        
        <div class="flex items-center mb-4">
          <div class="bg-gray-100 p-2 rounded-full mr-4">
            <span class="text-2xl">{{ getFoodEmoji(currentFood.name) }}</span>
          </div>
          <div>
            <h4 class="font-bold text-lg">{{ currentFood.name }}</h4>
            <p class="text-[#14a468] font-semibold">{{ getFoodCalories(currentFood.name) }} ‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà</p>
          </div>
        </div>
        
        <div class="bg-gray-50 p-3 rounded-md text-sm">
          <div class="flex justify-between mb-1">
            <span>‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô</span>
            <span class="font-semibold">{{ getFoodProtein(currentFood.name) }}g</span>
          </div>
          <div class="flex justify-between mb-1">
            <span>‡∏Ñ‡∏≤‡∏£‡πå‡πÇ‡∏ö‡πÑ‡∏Æ‡πÄ‡∏î‡∏£‡∏ï</span>
            <span class="font-semibold">{{ getFoodCarbs(currentFood.name) }}g</span>
          </div>
          <div class="flex justify-between">
            <span>‡πÑ‡∏Ç‡∏°‡∏±‡∏ô</span>
            <span class="font-semibold">{{ getFoodFat(currentFood.name) }}g</span>
          </div>
        </div>
      </div>
      
      <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£ -->
      <div v-else-if="scanActive || uploadedImage" class="bg-white rounded-lg shadow-lg p-6 mb-6 max-w-md mx-auto">
        <div class="flex items-center mb-4">
          <div class="bg-gray-100 p-2 rounded-full mr-4">
            <span class="text-2xl">‚ùì</span>
          </div>
          <div>
            <h4 class="font-bold text-lg">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏î‡πâ</h4>
            <p class="text-gray-600">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡∏†‡∏≤‡∏û‡∏≠‡∏∑‡πà‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</p>
          </div>
        </div>
        
        <div class="bg-yellow-50 p-3 rounded-md text-sm border border-yellow-100">
          <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏™‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
          <p class="mt-1 text-xs text-gray-500">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö: ‡∏Ç‡πâ‡∏≤‡∏ß‡πÑ‡∏Ç‡πà‡πÄ‡∏à‡∏µ‡∏¢‡∏ß, ‡∏Ç‡πâ‡∏≤‡∏ß‡∏Ç‡∏≤‡∏´‡∏°‡∏π, ‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏Å‡∏∏‡πâ‡∏á, ‡∏Ø‡∏•‡∏Ø</p>
        </div>
      </div>
      
      <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö -->
      <div class="mt-10 bg-gray-50 p-4 rounded-lg max-w-md mx-auto">
        <h3 class="font-semibold text-[#14a468] mb-2">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö</h3>
        <div class="grid grid-cols-2 gap-2 text-sm">
          <div v-for="(food, name) in foodDatabase" :key="name" class="flex items-center">
            <span class="mr-1">{{ food.emoji }}</span>
            <span>{{ name }}</span>
          </div>
        </div>
      </div>
      
      <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á) -->
      <div v-if="scanActive && !uploadedImage" id="label-container" class="space-y-1 text-gray-700 text-sm mt-4 max-w-md mx-auto bg-gray-50 p-3 rounded-md"></div>

  <div class="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100">
    <!-- Header Section -->
    <div class="bg-white/80 backdrop-blur-sm border-b border-slate-200/60">
      <div class="max-w-4xl mx-auto px-6 py-8">
        <div class="text-center">
          <h1 class="text-3xl font-bold text-slate-800 mb-2">‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h1>
          <p class="text-slate-600 max-w-md mx-auto">
            ‡∏™‡πÅ‡∏Å‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ AI ‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞
          </p>
        </div>
      </div>
    </div>

    <!-- Instructions Section -->
    <div class="max-w-4xl mx-auto px-6 py-12">
      <div class="bg-white rounded-3xl shadow-xl shadow-slate-200/50 p-8 mb-12">
        <div class="grid md:grid-cols-2 gap-12 items-center">
          <div>
            <h2 class="text-2xl font-semibold text-slate-800 mb-6">
              ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
            </h2>
            <div class="space-y-4">
              <div class="flex items-start space-x-4 group">
                <div
                  class="flex-shrink-0 w-8 h-8 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center font-semibold text-sm group-hover:bg-emerald-500 group-hover:text-white transition-colors duration-200"
                >
                  1
                </div>
                <div class="flex-1">
                  <p class="text-slate-700 font-medium">
                    ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏™‡πÅ‡∏Å‡∏ô‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏´‡∏≤‡∏£"
                  </p>
                  <p class="text-slate-500 text-sm mt-1">
                    ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
                  </p>
                </div>
              </div>

              <div class="flex items-start space-x-4 group">
                <div
                  class="flex-shrink-0 w-8 h-8 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center font-semibold text-sm group-hover:bg-emerald-500 group-hover:text-white transition-colors duration-200"
                >
                  2
                </div>
                <div class="flex-1">
                  <p class="text-slate-700 font-medium">
                    ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏õ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á
                  </p>
                  <p class="text-slate-500 text-sm mt-1">
                    ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ñ‡∏≤‡∏°
                  </p>
                </div>
              </div>

              <div class="flex items-start space-x-4 group">
                <div
                  class="flex-shrink-0 w-8 h-8 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center font-semibold text-sm group-hover:bg-emerald-500 group-hover:text-white transition-colors duration-200"
                >
                  3
                </div>
                <div class="flex-1">
                  <p class="text-slate-700 font-medium">
                    ‡∏ä‡∏µ‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏à‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£
                  </p>
                  <p class="text-slate-500 text-sm mt-1">
                    ‡∏à‡∏±‡∏î‡∏°‡∏∏‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
                  </p>
                </div>
              </div>

              <div class="flex items-start space-x-4 group">
                <div
                  class="flex-shrink-0 w-8 h-8 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center font-semibold text-sm group-hover:bg-emerald-500 group-hover:text-white transition-colors duration-200"
                >
                  4
                </div>
                <div class="flex-1">
                  <p class="text-slate-700 font-medium">
                    ‡∏£‡∏≠ AI ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
                  </p>
                  <p class="text-slate-500 text-sm mt-1">
                    ‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div class="flex justify-center">
            <div class="relative">
              <img
                src="https://spikeapi.com/wp-content/uploads/2024/07/nutrition_hero-1024x625.jpg"
                alt="‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏≠‡∏õ"
                class="rounded-2xl shadow-2xl max-w-full h-auto"
              />
              <div
                class="absolute inset-0 bg-gradient-to-t from-emerald-500/20 to-transparent rounded-2xl"
              ></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Scanner Section -->
      <div class="bg-white rounded-3xl shadow-xl shadow-slate-200/50 p-8">
        <div class="text-center mb-8">
          <h2 class="text-2xl font-semibold text-slate-800 mb-4">
            ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏™‡πÅ‡∏Å‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏•‡πâ‡∏≠‡∏á
          </h2>
          <p class="text-slate-600 mb-6">
            ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏≠‡∏≤‡∏´‡∏≤‡∏£
          </p>

          <button
            @click="init"
            :disabled="isLoading"
            class="inline-flex items-center px-8 py-4 bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white font-semibold rounded-2xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
          >
            <svg
              v-if="isLoading"
              class="animate-spin -ml-1 mr-3 h-5 w-5 text-white"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
            >
              <circle
                class="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
              ></circle>
              <path
                class="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
              ></path>
            </svg>
            <span v-if="!isLoading">üì± ‡∏™‡πÅ‡∏Å‡∏ô‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏´‡∏≤‡∏£</span>
            <span v-else>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span>
          </button>
        </div>

        <!-- Webcam Container -->
        <div class="flex justify-center mb-6">
          <div
            id="webcam-container"
            class="bg-slate-100 rounded-2xl p-4 min-h-[250px] flex items-center justify-center"
            :class="{ 'border-2 border-dashed border-slate-300': !isScanning }"
          >
            <div v-if="!isScanning" class="text-center text-slate-500">
              <div class="text-4xl mb-2">üì∏</div>
              <p>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á</p>
            </div>
          </div>
        </div>

        <!-- Results Container -->
        <div id="label-container" class="space-y-3" v-show="isScanning">
          <!-- Results will be populated here -->
        </div>

        <!-- Stop Button -->
        <div class="text-center mt-6" v-if="isScanning">
          <button
            @click="stopScanning"
            class="px-6 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 font-medium rounded-xl transition-colors duration-200"
          >
            ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô
          </button>
        </div>
      </div>

    </div>
  </div>
</template>

<script setup>
import { onBeforeUnmount, ref } from "vue";
import * as tmImage from "@teachablemachine/image";

const MODEL_URL = "https://teachablemachine.withgoogle.com/models/EB2h8Fb06/"
let model, webcam, labelContainer, maxPredictions;
const currentFood = ref(null);
const scanActive = ref(false);
const isLoading = ref(false);
const uploadedImage = ref(null);
const uploadedImageElement = ref(null);

// ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ (0.8 = 80%)
const CONFIDENCE_THRESHOLD = 0.8;

// ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà
const foodDatabase = {
  "‡∏Ç‡πâ‡∏≤‡∏ß‡πÑ‡∏Ç‡πà‡πÄ‡∏à‡∏µ‡∏¢‡∏ß": { calories: 450, protein: 15, carbs: 60, fat: 12, emoji: "üç≥" },
  "‡∏Ç‡πâ‡∏≤‡∏ß‡∏Ç‡∏≤‡∏´‡∏°‡∏π": { calories: 650, protein: 28, carbs: 70, fat: 25, emoji: "üçñ" },
  "‡πÑ‡∏Ç‡πà‡∏ï‡πâ‡∏°": { calories: 70, protein: 6, carbs: 0, fat: 5, emoji: "ü•ö" },
  "‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á": { calories: 350, protein: 5, carbs: 65, fat: 8, emoji: "ü•≠" },
  "‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏Å‡∏∏‡πâ‡∏á": { calories: 280, protein: 18, carbs: 10, fat: 12, emoji: "üç≤" },
  "‡∏ô‡πà‡∏≠‡∏á‡πÑ‡∏Å‡πà‡∏ó‡∏≠‡∏î": { calories: 320, protein: 22, carbs: 12, fat: 18, emoji: "üçó" },
  "‡∏ú‡∏±‡∏î‡∏ã‡∏µ‡∏≠‡∏¥‡πä‡∏ß": { calories: 520, protein: 15, carbs: 75, fat: 16, emoji: "üçú" },
  "‡πÅ‡∏û‡∏ô‡πÄ‡∏Ñ‡πâ‡∏Å": { calories: 380, protein: 8, carbs: 55, fat: 14, emoji: "ü•û" },
  "‡πÄ‡∏ü‡∏£‡∏ô‡∏ä‡πå‡∏ü‡∏£‡∏≤‡∏¢‡∏™‡πå": { calories: 310, protein: 4, carbs: 40, fat: 15, emoji: "üçü" },
  "‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡πâ‡∏•": { calories: 95, protein: 0.5, carbs: 25, fat: 0.3, emoji: "üçé" }
};

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏´‡∏≤‡∏£
function getFoodCalories(foodName) {
  return foodDatabase[foodName]?.calories || 0;
}

function getFoodProtein(foodName) {
  return foodDatabase[foodName]?.protein || 0;
}

function getFoodCarbs(foodName) {
  return foodDatabase[foodName]?.carbs || 0;
}

function getFoodFat(foodName) {
  return foodDatabase[foodName]?.fat || 0;
}


function getFoodEmoji(foodName) {
  return foodDatabase[foodName]?.emoji || "üçΩÔ∏è";
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•
async function loadModel() {
  isLoading.value = true;
  try {
    const modelURL = MODEL_URL + "model.json";
    const metadataURL = MODEL_URL + "metadata.json";
    model = await tmImage.load(modelURL, metadataURL);
    maxPredictions = model.getTotalClasses();
    
    // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ label container
    labelContainer = document.getElementById("label-container");
    if (labelContainer) {
      labelContainer.innerHTML = '';
      for (let i = 0; i < maxPredictions; i++) {
        labelContainer.appendChild(document.createElement("div"));
      }
    }
    return true;
  } catch (error) {
    console.error("Error loading model:", error);
    return false;
  } finally {
    isLoading.value = false;
  }
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏•‡πâ‡∏≠‡∏á
async function init() {
  currentFood.value = null;
  
  // ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏• (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÇ‡∏´‡∏•‡∏î)
  if (!model) {
    const success = await loadModel();
    if (!success) return;
  }
  
  // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡πâ‡∏≠‡∏á
  try {
    const flip = true;
    webcam = new tmImage.Webcam(400, 400, flip);
    await webcam.setup();
    await webcam.play();
    window.requestAnimationFrame(loop);

    // ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
    const webcamContainer = document.getElementById("webcam-container");
    if (webcamContainer) {
      webcamContainer.innerHTML = '';
      webcamContainer.appendChild(webcam.canvas);
    }
    
    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô
    scanActive.value = true;
  } catch (error) {
    console.error("Error initializing webcam:", error);
    alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Å‡∏•‡πâ‡∏≠‡∏á");
  }
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏•‡πâ‡∏≠‡∏á
function stopWebcam() {
  if (webcam) {
    webcam.stop();
    const webcamContainer = document.getElementById("webcam-container");
    if (webcamContainer) {
      webcamContainer.innerHTML = '';
    }
  }
  scanActive.value = false;
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
async function handleImageUpload(event) {
  const file = event.target.files[0];
  if (!file) return;
  
  // ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πâ‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà
  if (scanActive.value) {
    stopWebcam();
  }
  
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
  uploadedImage.value = URL.createObjectURL(file);
  
  // ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏• (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÇ‡∏´‡∏•‡∏î)
  if (!model) {
    const success = await loadModel();
    if (!success) return;
  }
  
  // ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
  setTimeout(() => {
    if (uploadedImageElement.value) {
      predictImage(uploadedImageElement.value);
    }
  }, 300);
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î
function clearImage() {
  if (uploadedImage.value) {
    URL.revokeObjectURL(uploadedImage.value);
    uploadedImage.value = null;
    currentFood.value = null;
  }
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î
async function predictImage(imgElement) {
  try {
    isLoading.value = true;
    const prediction = await model.predict(imgElement);
    
    // ‡∏´‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
    let highestPrediction = { confidence: 0 };
    
    for (let i = 0; i < maxPredictions; i++) {
      const classPrediction =
        prediction[i].className + ": " + prediction[i].probability.toFixed(2);
      
      if (labelContainer && labelContainer.childNodes[i]) {
        labelContainer.childNodes[i].innerHTML = classPrediction;
      }
      
      // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
      if (prediction[i].probability > highestPrediction.confidence) {
        highestPrediction = {
          name: prediction[i].className,
          confidence: prediction[i].probability
        };
      }
    }
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    if (highestPrediction.confidence >= CONFIDENCE_THRESHOLD) {
      currentFood.value = highestPrediction;
    } else {
      // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏î‡πâ
      currentFood.value = null;
    }
  } catch (error) {
    console.error("Error predicting image:", error);
    currentFood.value = null;
  } finally {
    isLoading.value = false;
  }
};

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏•‡πâ‡∏≠‡∏á)
async function loop() {
  if (!scanActive.value || !webcam) return;
  
  webcam.update();
  await predict();
  window.requestAnimationFrame(loop);
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡πâ‡∏≠‡∏á
async function predict() {
  const prediction = await model.predict(webcam.canvas);
  
  // ‡∏´‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
  let highestPrediction = { confidence: 0 };
  
  for (let i = 0; i < maxPredictions; i++) {
    const classPrediction =
      prediction[i].className + ": " + prediction[i].probability.toFixed(2);
    
    if (labelContainer && labelContainer.childNodes[i]) {
      labelContainer.childNodes[i].innerHTML = classPrediction;
    }
    
    // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
    if (prediction[i].probability > highestPrediction.confidence) {
      highestPrediction = {
        name: prediction[i].className,
        confidence: prediction[i].probability
      };
    }
  }
  
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
  if (highestPrediction.confidence >= CONFIDENCE_THRESHOLD) {
    currentFood.value = highestPrediction;
  } else {
    // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏î‡πâ
    currentFood.value = null;
  }
};

const stopScanning = () => {
  isScanning.value = false;
  if (webcam) {
    webcam.stop();
  }

  const container = document.getElementById("webcam-container");
  container.innerHTML = `
    <div class="text-center text-slate-500">
      <div class="text-4xl mb-2">üì∏</div>
      <p>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</p>
    </div>
  `;

  const labelContainer = document.getElementById("label-container");
  labelContainer.innerHTML = "";
};

// ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤
onBeforeUnmount(() => {
  stopWebcam();
  if (uploadedImage.value) {
    URL.revokeObjectURL(uploadedImage.value);
  }
});
</script>

<style scoped>
#webcam-container canvas {
  border-radius: 8px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

/* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Ñ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏≠‡∏≤‡∏´‡∏≤‡∏£ */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

div[v-if="currentFood"], div[v-else-if="scanActive"] {
  animation: fadeIn 0.3s ease-out;
}

/* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Ñ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û */
.fade-in {
  animation: fadeIn 0.3s ease-out;
}

/* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î */
input[type="file"] {
  display: none;
}
</style>